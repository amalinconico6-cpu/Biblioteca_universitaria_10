@startuml ModificaUtente
title Modifica utente

participant "Interfaccia" as UI
participant "ControllerUtenti" as C
participant "Lista_Utenti" as ListaUtenti
participant "Archivio esterno utenti" as ArchUtenti

note over UI
L'utente inserisce una matricola,
cerca l'utente e modifica i campi.
L'utente puÃ² anche essere cercato per nome e cognome.
end note

' --- Ricerca utente ---
UI -> C: click "Cerca" + matricola
C -> ListaUtenti: cercaPerMatricola(matricola)
ListaUtenti --> C: return List<Utente>

alt lista NON vuota (utente trovato)
    C -> C: utenteSelezionato = risultati.get(0)

    ' --- Mostra dati correnti (getter usati dalla UI) ---
    C --> UI: mostraDati(utenteSelezionato)

    ' --- Conferma modifica ---
    UI -> C: conferma modifica (nuovi dati)
    C -> C: crea Utente aggiornato (stessa matricola)

    C -> ListaUtenti: modificaUtente(utenteAggiornato)
    ListaUtenti --> C: return Utente oppure null

    alt modifica ok
        C -> ListaUtenti: salvataggioUtenti(nomefile)
        ListaUtenti -> ArchUtenti: writeObject(utenti)
        C --> UI: messaggio "Modifica effettuata"
    else modifica fallita
        C --> UI: messaggio "Utente non presente / modifica non riuscita"
    end

else lista vuota (utente NON trovato)
    C --> UI: messaggio "Utente non trovato"
end

@enduml
